飞书数据看板开发与部署指南
（基于 Next.js + 腾讯 EdgeOne 零费用方案）
一、项目概述
1.1 项目目标
开发轻量化数据看板，通过飞书表格 API 直接获取业务数据并可视化展示，部署于腾讯 EdgeOne 边缘平台，实现零费用、高可用的数据监控工具。
1.2 核心优势
无需数据库，直接对接飞书数据源，降低维护成本
边缘节点部署，提升多地区访问速度
全流程使用免费资源，适合中小团队 / 个人
1.3 适用场景
业务数据实时监控（每日 / 月度收支、利润分析）
飞书表格数据可视化展示
低成本数据看板快速搭建
二、数据来源说明
2.1 飞书表格信息
表格名称	表格 ID	核心字段示例
每日基础表	tbla2p0tHEBb6Xnj	date（日期）、daily_profit（每日盈利）、payment_expense（货款支出）
月度汇总表	tbl5hVlzM1gNVCT2	month（月份）、month_profit（月净利润）、net_cashflow（净现金流）
2.2 API 凭证（已提供）
env
# 飞书应用凭证  
FEISHU_APP_ID=cli_a85bf6b4153bd013  
FEISHU_APP_SECRET=AhOGT0tl2pkjXlynQ2Qb3gFXyXmbE2aP  

# 表格访问配置  
NEXT_PUBLIC_FEISHU_APP_TOKEN=R8XfbOXZ2a4fJjsWdpmc1rJOnbm  
NEXT_PUBLIC_FEISHU_TABLE_BASE_DAILY=tbla2p0tHEBb6Xnj  
NEXT_PUBLIC_FEISHU_TABLE_MONTH_SUMMARY=tbl5hVlzM1gNVCT2  
三、功能模块设计
3.1 核心功能清单
模块	具体功能
数据获取	前端直接调用飞书 API，通过 EdgeOne 转发解决跨域；支持本地缓存（1 小时）
数据处理	数值格式化（保留 2 位小数）、日期转换（YYYY-MM-DD）、排序（按时间升序）
概览展示	关键指标卡片（当日利润、当月净利润、总支出、净现金流等）
趋势分析	每日利润折线图（支持日期筛选）、月度利润对比柱状图
结构分析	支出占比饼图（货款 / 其他支出 / 服务费）、平台费用对比图（拼多多 vs 抖音）
明细查询	每日数据表格（支持排序 / 筛选）、月度汇总表格
交互功能	时间范围筛选（今日 / 本周 / 本月 / 自定义）、图表悬停详情、手动刷新按钮
四、技术栈与环境准备
4.1 技术栈选型
类别	技术选择	选型理由
前端框架	Next.js 14+	支持增量静态再生成（ISR），平衡静态部署性能与数据实时性
UI 组件库	Ant Design 5.x + ProComponents	提供数据看板预制组件（卡片、表格、筛选器），减少开发量
图表库	Recharts	轻量（30KB）、React 友好，适合基础图表（折线 / 柱状 / 饼图）
API 请求	Axios	处理飞书 API 调用、请求防抖（500ms）、错误重试（最多 3 次）
部署平台	腾讯 EdgeOne（免费版）	提供边缘加速、API 转发、缓存策略，零费用覆盖轻量需求

# 飞书对接的表格
FEISHU_APP_ID=cli_a85bf6b4153bd013
FEISHU_APP_SECRET=AhOGT0tl2pkjXlynQ2Qb3gFXyXmbE2aP
NEXT_PUBLIC_FEISHU_APP_TOKEN=R8XfbOXZ2a4fJjsWdpmc1rJOnbm
NEXT_PUBLIC_FEISHU_TABLE_BASE_DAILY=tbla2p0tHEBb6Xnj
NEXT_PUBLIC_FEISHU_TABLE_MONTH_SUMMARY=tbl5hVlzM1gNVCT2
NEXT_PUBLIC_FEISHU_APP_TOKEN_DOMESTIC=R8XfbOXZ2a4fJjsWdpmc1rJOnbm


## 6. 表结构与字段设计建议

### 6.1 主要业务表格及字段

#### 每日基础表（base_daily）
- date             日期（date）
- claim_amount     赔付申请金额（numeric）
- daily_profit     每日盈利（numeric）
- other_expense    其他支出（numeric）
- payment_expense  货款支出（numeric）
- withdraw_amount  提现金额（numeric）
- profit_summary   每日利润汇总（numeric/公式）

#### 赔付金额（claim_detail）
- date             日期（date）
- order_id         订单编号（text）
- claim_amount     赔付金额（numeric）
- source           来源（text/标签）
- note             特别说明（text）

#### 硬性支出（hard_expense）
- date             日期（date）
- amount           金额（numeric）
- note             备注（text）

#### 月度汇总表（month_summary）
- month            月份（text）
- daily_profit_sum 每日利润总计（numeric/公式）
- month_profit     月净利润（numeric/公式）
- claim_amount_sum 总赔付申请金额汇总（numeric/公式）
- pdd_service_fee  总拼多多技术服务费（numeric/公式）
- douyin_service_fee 总抖音技术服务费（numeric/公式）
- shipping_insurance 运费保险（numeric/公式）
- other_expense_sum 总其他支出汇总（numeric/公式）
- hard_expense     硬性支出（numeric/公式）
- qianchuan        千川投流（numeric/公式）
- payment_expense_sum 总货款支出汇总（numeric/公式）
- withdraw_amount  提现金额（numeric/公式）
- deposit          店铺保证金（numeric/公式）
- initial_fund     初始资金（numeric/公式）
- net_cashflow     累计净现金流（numeric/公式）

#### 店铺保证金（deposit）
- date             日期（date）
- amount           金额（numeric）
- note             备注（text）

#### 千川投流（qianchuan）
- date             日期（date）
- amount           金额（numeric）
- note             备注（text）

#### 年度总利润（year_profit）
- year             年份（text）
- profit_with_deposit    含保证金利润（numeric/公式）
- total_profit_with_deposit 含保证金总利润（numeric/公式）
- profit_without_deposit 不含保证金利润（numeric/公式）
- net_profit_without_deposit 不含保证金余利润（numeric/公式）

#### 年度总支出（year_expense）
- year             年份（text）
- detail           费用明细（text）
- amount           金额（numeric）

整体布局
采用「顶部核心指标卡片 + 中间双趋势图表 + 底部双结构图表」的三层布局，风格简洁专业，主色调以蓝色系为主（体现数据严谨性）。
1. 顶部核心指标卡片区（4 张关键数据卡）
plaintext
┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐
│ 今日盈利         │   │ 当月净利润       │   │ 累计净现金流     │   │ 当月总赔付申请   │
│ ¥12,345.67      │   │ ¥89,012.34      │   │ ¥234,567.89     │   │ ¥56,789.01      │
│ 昨日：¥10,987.65 ↑│   │ 上月：¥78,901.23 ↑│   │ 环比上月 +12.3%  │   │ 上月：¥45,678.90 ↑│
└─────────────────┘   └─────────────────┘   └─────────────────┘   └─────────────────┘
数据来源：
今日盈利 → base_daily.daily_profit（当日最新记录）
当月净利润 → month_summary.month_profit（当月记录）
累计净现金流 → month_summary.net_cashflow（当月记录，反映资金健康度）
当月总赔付申请 → month_summary.claim_amount_sum（当月赔付申请汇总）
2. 中间趋势图表区
左侧：日盈利趋势（折线图）
plaintext
┌──────────────────────────────────────────┐
│ 日盈利趋势（近7天）                      │
│ ┌──────────────────────────────────────┐ │
│ │ 今日（蓝线）：波动上升                │ │
│ │ 昨日（灰线）：相对平稳                │ │
│ └──────────────────────────────────────┘ │
│ X轴：日期（如 9.18-9.24）  Y轴：日盈利金额   │
└──────────────────────────────────────────┘
数据来源：base_daily.date（近 7 天日期） + base_daily.daily_profit（对应日盈利）
右侧：月度净利润与赔付申请对比（双轴混合图）
plaintext
┌──────────────────────────────────────────┐
│ 月度净利润 vs 总赔付申请                │
│ ┌──────────────────────────────────────┐ │
│ │ 净利润（蓝柱）：逐月增长              │ │
│ │ 赔付申请（橙线）：波动上升            │ │
│ └──────────────────────────────────────┘ │
│ X轴：月份（如 2025.04-2025.09）          │
│ 左Y轴：净利润   右Y轴：赔付申请金额     │
└──────────────────────────────────────────┘
数据来源：month_summary.month（月份） + month_summary.month_profit（月净利润） + month_summary.claim_amount_sum（月赔付申请汇总）
3. 底部结构分析区
左侧：月度支出构成（饼图）
plaintext
┌──────────────────────────────────────────┐
│ 月度支出构成（2025.09）                  │
│ ┌──────────────────────────────────────┐ │
│ │ 货款支出（45%） ○ 蓝色                │ │
│ │ 其他支出（20%） ○ 绿色                │ │
│ │ 拼多多服务费（15%）○ 橙色             │ │
│ │ 抖音服务费（10%） ○ 紫色             │ │
│ │ 运费保险（10%） ○ 灰色                │ │
│ └──────────────────────────────────────┘ │
└──────────────────────────────────────────┘
数据来源：month_summary.payment_expense_sum（货款支出）、other_expense_sum（其他支出）、pdd_service_fee（拼多多服务费）、douyin_service_fee（抖音服务费）、shipping_insurance（运费保险）（当月汇总，计算各部分占总支出的比例）
右侧：平台服务费趋势（双柱状图）
plaintext
┌──────────────────────────────────────────┐
│ 平台技术服务费趋势（近6个月）            │
│ ┌──────────────────────────────────────┐ │
│ │ 拼多多（蓝柱）：5月起逐步增长         │ │
│ │ 抖音（橙柱）：持续平稳                │ │
│ └──────────────────────────────────────┘ │
│ X轴：月份（如 2025.04-2025.09）          │
│ Y轴：服务费金额                         │
└──────────────────────────────────────────┘
数据来源：month_summary.month（月份） + pdd_service_fee（拼多多服务费） + douyin_service_fee（抖音服务费）
交互与筛选
顶部全局筛选：「今日」「本周」「本月」「近 30 天」「自定义日期」按钮，点击可切换数据统计范围。
图表交互：hover 时显示具体数值（如折线图某点的 “日期：9.24，盈利：¥12,345.67”）；点击图表区块可展开对应明细数据（如点击饼图 “货款支出”，可弹出 “日度货款支出列表”）。
该设计围绕飞书表格的日度经营数据和月度汇总数据展开，既覆盖「核心财务指标监控」（盈利、现金流、赔付），也体现「趋势变化」（日 / 月维度）与「结构分析」（支出构成、平台成本对比），逻辑清晰且易读。
